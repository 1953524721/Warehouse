<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <style type="text/css">
        html{height:100%}
        body{height:100%;margin:0px;padding:0px}
        #container{height:100%}
    </style>
    <title>Document</title>
</head>
<body>
    地图组件
    <div id="container"></div>
</body>
<script type="text/javascript">
    function loadBMap(ak) {
        return new Promise((resolve) => {
            if (typeof BMap !== 'undefined') {
                resolve(BMap);
                return;
            }
            window.onBMapCallback = () => { resolve(BMap) }; // 全局回调
            const script = document.createElement('script');
            script.src = `http://api.map.baidu.com/api?v=3.0&ak={$ak}&callback=onBMapCallback`;
            script.onerror = (error) => { /* 处理错误 */ };
            document.head.appendChild(script);
        });
    }

    // 使用示例
    loadBMap('{$ak}').then((BMap) => {
        // 初始化地图
        const map = new BMap.Map('container');
    });

</script>
</html>
